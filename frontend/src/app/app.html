<div class="container">
  <!-- Header -->
  <header class="header">
    <h1>{{ title }}</h1>
    <p class="subtitle">Calculate values from the LabSeq sequence</p>
    <div class="api-status" [class.connected]="apiStatus.includes('âœ“')" [class.disconnected]="apiStatus.includes('âœ—')">
      API Status: {{ apiStatus }}
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Calculator Card -->
    <div class="card calculator-card">
      <h2>Calculate LabSeq Value</h2>
      
      <div class="info-box">
        <strong>Sequence Definition:</strong>
        <ul>
          <li>l(0) = 0</li>
          <li>l(1) = 1</li>
          <li>l(2) = 0</li>
          <li>l(3) = 1</li>
          <li>l(n) = l(n-4) + l(n-3) for n > 3</li>
        </ul>
      </div>

      <form (ngSubmit)="calculate()" class="calculator-form">
        <div class="form-group">
          <label for="indexInput">Enter Index (n):</label>
          <input
            type="number"
            id="indexInput"
            [(ngModel)]="inputValue"
            name="indexInput"
            placeholder="e.g., 10, 100, 1000..."
            min="0"
            step="1"
            class="form-control"
            [disabled]="loading"
          />
        </div>

        <div class="button-group">
          <button type="submit" class="btn btn-primary" [disabled]="loading || inputValue === null">
            <span *ngIf="!loading">Calculate</span>
            <span *ngIf="loading">Calculating...</span>
          </button>
          <button type="button" class="btn btn-secondary" (click)="reset()" [disabled]="loading">
            Reset
          </button>
        </div>
      </form>

      <!-- Error Message -->
      <div *ngIf="error" class="alert alert-error">
        <strong>Error:</strong> {{ error }}
      </div>

      <!-- Result -->
      <div *ngIf="result" class="result-container">
        <h3>Result</h3>
        <div class="result-card">
          <div class="result-row">
            <span class="result-label">Index (n):</span>
            <span class="result-value">{{ result.index }}</span>
          </div>
          <div class="result-row">
            <span class="result-label">Value:</span>
            <span class="result-value highlight">{{ result.value }}</span>
          </div>
          <div class="result-row">
            <span class="result-label">Calculation Time:</span>
            <span class="result-value">{{ result.calculationTimeMs }} ms</span>
          </div>
          <div class="result-row">
            <span class="result-label">Source:</span>
            <span class="result-value" [class.cached]="result.fromCache">
              {{ result.fromCache ? 'ðŸ“¦ From Cache' : 'ðŸ”„ Fresh Calculation' }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- History Card -->
    <div class="card history-card" *ngIf="history.length > 0">
      <div class="history-header">
        <h2>Calculation History</h2>
        <button class="btn btn-clear" (click)="clearHistory()">Clear History</button>
      </div>
      
      <div class="history-list">
        <div *ngFor="let item of history" class="history-item" (click)="loadFromHistory(item.index)">
          <div class="history-main">
            <span class="history-index">n = {{ item.index }}</span>
            <span class="history-value">{{ item.value }}</span>
          </div>
          <div class="history-meta">
            <span class="history-time">{{ item.calculationTimeMs }}ms</span>
            <span class="history-cache" *ngIf="item.fromCache">ðŸ“¦ Cached</span>
            <span class="history-timestamp">{{ item.timestamp | date:'short' }}</span>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="footer">
    <p>LabSeq API - Built with Quarkus & Angular</p>
    <a href="http://localhost:8080/q/swagger-ui" target="_blank" class="swagger-link">
      ðŸ“– View API Documentation
    </a>
  </footer>
</div>